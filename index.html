<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš‘ ìš°ë¦¬ ë™ë„¤ ì‘ê¸‰ì˜ë£Œê¸°ê´€ ì°¾ê¸°</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Jua', sans-serif;
            background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
            min-height: 100vh;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(255, 182, 193, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(144, 238, 144, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(173, 216, 230, 0.3) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
        
        .header {
            background: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: repeating-linear-gradient(
                90deg,
                #FF6B6B 0px,
                #FF6B6B 10px,
                #4ECDC4 10px,
                #4ECDC4 20px
            );
        }
        
        h1 {
            color: #2C3E50;
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .emoji {
            font-size: 35px;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
        }
        
        .radius-buttons {
            display: flex;
            gap: 10px;
        }
        
        .radius-btn {
            padding: 12px 24px;
            border: 3px solid #4ECDC4;
            background: white;
            color: #4ECDC4;
            border-radius: 30px;
            font-size: 16px;
            font-family: 'Jua', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(78, 205, 196, 0.2);
        }
        
        .radius-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(78, 205, 196, 0.3);
        }
        
        .radius-btn.active {
            background: #4ECDC4;
            color: white;
            transform: scale(1.05);
        }
        
        .search-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            font-family: 'Jua', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }
        
        .map-container {
            background: white;
            padding: 15px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            position: relative;
        }
        
        #map {
            width: 100%;
            height: 500px;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 1000;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #4ECDC4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .list-container {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .list-header {
            font-size: 22px;
            color: #2C3E50;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #E8F5FF;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .place-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .place-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .place-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .place-list::-webkit-scrollbar-thumb {
            background: #4ECDC4;
            border-radius: 10px;
        }
        
        .place-item {
            padding: 20px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #FAFAFA 0%, #F5F5F5 100%);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .place-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: #4ECDC4;
            transform: translateX(-5px);
            transition: transform 0.3s ease;
        }
        
        .place-item:hover {
            transform: translateX(5px);
            border-color: #4ECDC4;
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.2);
        }
        
        .place-item:hover::before {
            transform: translateX(0);
        }
        
        .place-name {
            font-size: 18px;
            color: #2C3E50;
            margin-bottom: 8px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .place-category {
            display: inline-block;
            padding: 4px 10px;
            background: #FFE082;
            color: #F57C00;
            border-radius: 15px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .place-info {
            color: #7F8C8D;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .place-distance {
            color: #4ECDC4;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .education-box {
            background: linear-gradient(135deg, #FFE5B4 0%, #FFDAB9 100%);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(255, 218, 185, 0.5);
            text-align: center;
            border: 3px dashed #FFA726;
        }
        
        .education-title {
            font-size: 20px;
            color: #E65100;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .education-content {
            color: #5D4037;
            line-height: 1.8;
            font-size: 16px;
        }
        
        .emergency-number {
            display: inline-block;
            background: #FF5252;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            margin: 10px 5px;
            font-size: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .custom-overlay {
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            min-width: 250px;
            position: relative;
        }
        
        .custom-overlay::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid white;
        }
        
        .overlay-title {
            font-size: 16px;
            font-weight: bold;
            color: #2C3E50;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid #E8F5FF;
        }
        
        .overlay-content {
            color: #7F8C8D;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .overlay-link {
            display: inline-block;
            margin-top: 10px;
            padding: 8px 16px;
            background: #4ECDC4;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .overlay-link:hover {
            background: #45B7AA;
            transform: translateY(-2px);
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #95A5A6;
            font-size: 18px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #7F8C8D;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 22px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .radius-buttons {
                width: 100%;
                justify-content: center;
            }
            
            #map {
                height: 400px;
            }
            
            .place-list {
                max-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>
            <span class="emoji">ğŸš‘</span>
            ìš°ë¦¬ ë™ë„¤ ì‘ê¸‰ì˜ë£Œê¸°ê´€ ì°¾ê¸°
            <span class="emoji">ğŸ¥</span>
        </h1>
    </div>
    
    <div class="container">
        <div class="controls">
            <div class="radius-buttons">
                <button class="radius-btn" data-radius="3000">3km</button>
                <button class="radius-btn active" data-radius="5000">5km</button>
                <button class="radius-btn" data-radius="10000">10km</button>
            </div>
            <button class="search-btn" onclick="searchNearbyPlaces()">
                <span>ğŸ”</span>
                <span>ë‚´ ì£¼ë³€ ì°¾ê¸°</span>
            </button>
        </div>
        
        <div class="map-container">
            <div id="map"></div>
            <div class="loading" id="loading" style="display: none;">
                <div class="loading-spinner"></div>
                <div>ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ê³  ìˆì–´ìš”...</div>
            </div>
        </div>
        
        <div class="list-container">
            <div class="list-header">
                <span>ğŸ“‹</span>
                <span>ì£¼ë³€ ì˜ë£Œê¸°ê´€ ëª©ë¡</span>
                <span id="place-count" style="color: #4ECDC4; font-size: 18px;"></span>
            </div>
            <div class="place-list" id="placeList">
                <div class="no-results">
                    í˜„ì¬ ìœ„ì¹˜ë¥¼ í™•ì¸í•œ í›„ 'ë‚´ ì£¼ë³€ ì°¾ê¸°' ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”! ğŸ”
                </div>
            </div>
        </div>
        
        <div class="education-box">
            <div class="education-title">
                <span>ğŸ“š</span>
                <span>ì‘ê¸‰ìƒí™© ëŒ€ì²˜ ë°©ë²•</span>
                <span>ğŸ“š</span>
            </div>
            <div class="education-content">
                <strong>ì‘ê¸‰ìƒí™©ì´ ë°œìƒí–ˆì„ ë•ŒëŠ”</strong><br>
                <span class="emergency-number">â˜ï¸ 119</span>
                <span class="emergency-number">â˜ï¸ 112</span><br>
                ì— ì¦‰ì‹œ ì‹ ê³ í•˜ê³ , ê°€ê¹Œìš´ ì‘ê¸‰ì˜ë£Œê¸°ê´€ì„ í™•ì¸í•˜ì„¸ìš”!<br><br>
                ğŸ’¡ <strong>Tip:</strong> í‰ì†Œì— ìš°ë¦¬ ë™ë„¤ ì‘ê¸‰ì‹¤ ìœ„ì¹˜ë¥¼ ë¯¸ë¦¬ ì•Œì•„ë‘ë©´ ì¢‹ì•„ìš”!<br>
                ì´ ì§€ë„ëŠ” ë³´ê±´ ìˆ˜ì—… í•™ìŠµìš©ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ğŸ“–
            </div>
        </div>
    </div>
    
    <div class="footer">
        Made with â¤ï¸ for ì¤‘í•™êµ ë³´ê±´êµê³¼ ì‘ê¸‰ì²˜ì¹˜ ë‹¨ì›
    </div>
    
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=c76378cfce34b51a13162d0b2c9705c2&libraries=services,clusterer"></script>
    
    <script>
        // API í‚¤ ì„¤ì • (ì‹¤ì œ ë°œê¸‰ë°›ì€ í‚¤ë¡œ ì„¤ì • ì™„ë£Œ)
        const JS_KEY = "c76378cfce34b51a13162d0b2c9705c2";  // JavaScript í‚¤
        const REST_KEY = "481144fd197c15cc2cb5b2b0b9ba2912";  // REST API í‚¤
        
        let map;
        let markers = [];
        let overlays = [];
        let currentPosition;
        let selectedRadius = 5000;
        let circle;
        
        // ë°˜ê²½ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.querySelectorAll('.radius-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.radius-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                selectedRadius = parseInt(this.dataset.radius);
                
                // ì› ë‹¤ì‹œ ê·¸ë¦¬ê¸°
                if (circle) {
                    circle.setRadius(selectedRadius);
                }
                
                // ì¬ê²€ìƒ‰
                if (currentPosition) {
                    searchNearbyPlaces();
                }
            });
        });
        
        // ì§€ë„ ì´ˆê¸°í™”
        function initMap() {
            const container = document.getElementById('map');
            const options = {
                center: new kakao.maps.LatLng(37.5665, 126.9780), // ì„œìš¸ ì‹œì²­ ê¸°ë³¸ ìœ„ì¹˜
                level: 5
            };
            
            map = new kakao.maps.Map(container, options);
            
            // ì§€ë„ ì»¨íŠ¸ë¡¤ ì¶”ê°€
            const mapTypeControl = new kakao.maps.MapTypeControl();
            map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
            
            const zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
            
            // í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
            getCurrentLocation();
        }
        
        // í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
        function getCurrentLocation() {
            const loading = document.getElementById('loading');
            loading.style.display = 'block';
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        currentPosition = new kakao.maps.LatLng(
                            position.coords.latitude,
                            position.coords.longitude
                        );
                        
                        // ì§€ë„ ì¤‘ì‹¬ ì´ë™
                        map.setCenter(currentPosition);
                        
                        // í˜„ì¬ ìœ„ì¹˜ ë§ˆì»¤ í‘œì‹œ
                        const currentMarkerImage = new kakao.maps.MarkerImage(
                            'data:image/svg+xml;base64,' + btoa(`
                                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
                                    <circle cx="20" cy="20" r="18" fill="#4ECDC4" opacity="0.9"/>
                                    <circle cx="20" cy="20" r="10" fill="white"/>
                                    <circle cx="20" cy="20" r="6" fill="#4ECDC4"/>
                                </svg>
                            `),
                            new kakao.maps.Size(40, 40)
                        );
                        
                        const currentMarker = new kakao.maps.Marker({
                            position: currentPosition,
                            map: map,
                            image: currentMarkerImage,
                            title: 'í˜„ì¬ ìœ„ì¹˜'
                        });
                        
                        // ë°˜ê²½ ì› ê·¸ë¦¬ê¸°
                        drawRadiusCircle();
                        
                        loading.style.display = 'none';
                        
                        // ìë™ìœ¼ë¡œ ì£¼ë³€ ê²€ìƒ‰
                        searchNearbyPlaces();
                    },
                    function(error) {
                        loading.style.display = 'none';
                        alert('ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ìœ„ì¹˜ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.');
                        console.error('Geolocation error:', error);
                    }
                );
            } else {
                loading.style.display = 'none';
                alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë°˜ê²½ ì› ê·¸ë¦¬ê¸°
        function drawRadiusCircle() {
            if (circle) {
                circle.setMap(null);
            }
            
            circle = new kakao.maps.Circle({
                center: currentPosition,
                radius: selectedRadius,
                strokeWeight: 2,
                strokeColor: '#4ECDC4',
                strokeOpacity: 0.8,
                strokeStyle: 'dashed',
                fillColor: '#4ECDC4',
                fillOpacity: 0.1
            });
            
            circle.setMap(map);
        }
        
        // ì£¼ë³€ ì˜ë£Œê¸°ê´€ ê²€ìƒ‰
        async function searchNearbyPlaces() {
            if (!currentPosition) {
                alert('ë¨¼ì € í˜„ì¬ ìœ„ì¹˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            const loading = document.getElementById('loading');
            loading.style.display = 'block';
            
            clearMarkers();
            
            const keywords = ['ì‘ê¸‰ì‹¤', 'ë³‘ì›', 'ë³´ê±´ì†Œ'];
            let allPlaces = [];
            
            try {
                for (const keyword of keywords) {
                    const places = await searchByKeyword(keyword);
                    allPlaces = allPlaces.concat(places);
                }
                
                // ì¤‘ë³µ ì œê±°
                allPlaces = removeDuplicates(allPlaces);
                
                // ê±°ë¦¬ìˆœ ì •ë ¬
                allPlaces.sort((a, b) => a.distance - b.distance);
                
                displayPlaces(allPlaces);
                loading.style.display = 'none';
                
            } catch (error) {
                console.error('ê²€ìƒ‰ ì˜¤ë¥˜:', error);
                loading.style.display = 'none';
                alert('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // í‚¤ì›Œë“œë¡œ ì¥ì†Œ ê²€ìƒ‰ (REST API ì‚¬ìš©)
        function searchByKeyword(keyword) {
            return new Promise((resolve, reject) => {
                // Kakao Maps SDKì˜ Places ì„œë¹„ìŠ¤ ì‚¬ìš©
                const ps = new kakao.maps.services.Places();
                
                ps.keywordSearch(keyword, function(data, status) {
                    if (status === kakao.maps.services.Status.OK) {
                        const filtered = data.filter(place => {
                            const placePosition = new kakao.maps.LatLng(place.y, place.x);
                            const distance = getDistance(currentPosition, placePosition);
                            place.distance = distance;
                            return distance <= selectedRadius;
                        });
                        resolve(filtered);
                    } else {
                        resolve([]);
                    }
                }, {
                    location: currentPosition,
                    radius: selectedRadius,
                    size: 15
                });
            });
        }
        
        // ê±°ë¦¬ ê³„ì‚°
        function getDistance(pos1, pos2) {
            const line = new kakao.maps.Polyline({
                path: [pos1, pos2]
            });
            return line.getLength();
        }
        
        // ì¤‘ë³µ ì œê±°
        function removeDuplicates(places) {
            const uniquePlaces = [];
            const seen = new Set();
            
            places.forEach(place => {
                const key = `${place.place_name}_${place.address_name}`;
                if (!seen.has(key)) {
                    seen.add(key);
                    uniquePlaces.push(place);
                }
            });
            
            return uniquePlaces;
        }
        
        // ì¥ì†Œ í‘œì‹œ
        function displayPlaces(places) {
            const listEl = document.getElementById('placeList');
            const countEl = document.getElementById('place-count');
            
            if (places.length === 0) {
                listEl.innerHTML = '<div class="no-results">ì£¼ë³€ì— ì˜ë£Œê¸°ê´€ì´ ì—†ìŠµë‹ˆë‹¤. ë°˜ê²½ì„ ëŠ˜ë ¤ë³´ì„¸ìš”! ğŸ”</div>';
                countEl.textContent = '';
                return;
            }
            
            countEl.textContent = `(ì´ ${places.length}ê°œ)`;
            listEl.innerHTML = '';
            
            places.forEach((place, index) => {
                // ë§ˆì»¤ ìƒì„±
                const position = new kakao.maps.LatLng(place.y, place.x);
                const marker = createMarker(position, place, index);
                markers.push(marker);
                
                // ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„±
                const listItem = createListItem(place, index);
                listEl.appendChild(listItem);
            });
            
            // ì§€ë„ ë²”ìœ„ ì¡°ì •
            const bounds = new kakao.maps.LatLngBounds();
            bounds.extend(currentPosition);
            markers.forEach(marker => {
                bounds.extend(marker.getPosition());
            });
            map.setBounds(bounds);
        }
        
        // ë§ˆì»¤ ìƒì„±
        function createMarker(position, place, index) {
            // ë³‘ì› ì•„ì´ì½˜ ë§ˆì»¤ ì´ë¯¸ì§€
            const markerImage = new kakao.maps.MarkerImage(
                'data:image/svg+xml;base64,' + btoa(`
                    <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 45 45">
                        <g transform="translate(22.5, 35)">
                            <path d="M 0 0 L -8 -15 A 10 10 0 1 1 8 -15 Z" fill="#FF6B6B" stroke="white" stroke-width="2"/>
                        </g>
                        <rect x="17" y="10" width="11" height="11" fill="white"/>
                        <rect x="20" y="13" width="5" height="2" fill="#FF6B6B"/>
                        <rect x="21.5" y="11.5" width="2" height="5" fill="#FF6B6B"/>
                    </svg>
                `),
                new kakao.maps.Size(45, 45),
                {offset: new kakao.maps.Point(22, 45)}
            );
            
            const marker = new kakao.maps.Marker({
                position: position,
                map: map,
                image: markerImage
            });
            
            // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´
            const overlay = createOverlay(position, place);
            overlays.push(overlay);
            
            // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸
            kakao.maps.event.addListener(marker, 'click', function() {
                closeAllOverlays();
                overlay.setMap(map);
            });
            
            return marker;
        }
        
        // ì˜¤ë²„ë ˆì´ ìƒì„±
        function createOverlay(position, place) {
            const content = `
                <div class="custom-overlay">
                    <div class="overlay-title">${place.place_name}</div>
                    <div class="overlay-content">
                        <div>ğŸ“ ${place.address_name}</div>
                        ${place.phone ? `<div>ğŸ“ ${place.phone}</div>` : ''}
                        <div>ğŸ“ ${formatDistance(place.distance)}</div>
                    </div>
                    <a href="https://map.kakao.com/link/to/${place.place_name},${place.y},${place.x}" 
                       target="_blank" class="overlay-link">
                        ğŸš— ê¸¸ì°¾ê¸°
                    </a>
                </div>
            `;
            
            const overlay = new kakao.maps.CustomOverlay({
                position: position,
                content: content,
                yAnchor: 1.3,
                clickable: true
            });
            
            return overlay;
        }
        
        // ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„±
        function createListItem(place, index) {
            const item = document.createElement('div');
            item.className = 'place-item';
            
            const category = place.category_name.includes('ì‘ê¸‰') ? 'ì‘ê¸‰ì‹¤' : 
                           place.category_name.includes('ë³´ê±´') ? 'ë³´ê±´ì†Œ' : 'ë³‘ì›';
            
            item.innerHTML = `
                <div class="place-name">
                    ğŸ¥ ${place.place_name}
                    <span class="place-category">${category}</span>
                </div>
                <div class="place-info">
                    <div>ğŸ“ ì£¼ì†Œ: ${place.address_name}</div>
                    ${place.phone ? `<div>ğŸ“ ì „í™”: ${place.phone}</div>` : '<div>ğŸ“ ì „í™”: ì •ë³´ ì—†ìŒ</div>'}
                    <div class="place-distance">ğŸ“ ê±°ë¦¬: ${formatDistance(place.distance)}</div>
                </div>
            `;
            
            item.addEventListener('click', function() {
                const position = new kakao.maps.LatLng(place.y, place.x);
                map.setCenter(position);
                map.setLevel(3);
                
                closeAllOverlays();
                overlays[index].setMap(map);
            });
            
            return item;
        }
        
        // ê±°ë¦¬ í¬ë§·
        function formatDistance(distance) {
            if (distance < 1000) {
                return Math.round(distance) + 'm';
            } else {
                return (distance / 1000).toFixed(1) + 'km';
            }
        }
        
        // ë§ˆì»¤ ì œê±°
        function clearMarkers() {
            markers.forEach(marker => marker.setMap(null));
            markers = [];
            closeAllOverlays();
        }
        
        // ëª¨ë“  ì˜¤ë²„ë ˆì´ ë‹«ê¸°
        function closeAllOverlays() {
            overlays.forEach(overlay => overlay.setMap(null));
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì§€ë„ ì´ˆê¸°í™”
        window.onload = function() {
            // API í‚¤ ì„¤ì • ì™„ë£Œ - ë°”ë¡œ ì§€ë„ ì´ˆê¸°í™”
            initMap();
        };
    </script>
</body>
</html>
